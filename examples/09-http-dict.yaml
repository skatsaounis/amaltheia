## Amaltheia Job
## Author: Aggelos Kolaitis
## Description: Get hosts from API. From dict response, with filter

## Assuming API is:
## GET http://localhost:5000/
## {
##   "hosts": {
##     "myhost-1": {"updates": []},
##     "myhost-2": {"updates": ["dummy"]},
##     "machine-3": {"updates": ["dummy"]},         /* will not be returned by discoverer */
##   }
## }

## Parameters:
## (none)

## Usage 1:
##  $ amaltheia -s this-file.yaml

---
config:
  color: true
  openstack-rc: /path/to/openstack.rc   # openstack credentials rc file
  ssh-user: ubuntu
  ssh-id-rsa-file: /path/to/ssh-id-rsa
  # ssh-id-rsa-password: key-password   # (optional) private key password
  ssh-config-file: /path/to/ssh-config  # (optional) ssh-config file
  ssh-strict-host-key-checking: false
  log-level: debug                      # debug/info/warning/error/fatal
strategy: serial
hosts:
- http:
    request:
      url: http://localhost:5000/
      method: GET
    results: '{{ response.hosts }}'
    match:
    - regex: 'myhost'
      value: '{{ item.key }}'
    parse:
      host-name: '{{ item.key }}'
      host-args: '{{ item.value }}'
services: []
updates: []
